!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):global.PointerEventsPolyfill=factory()}(this,function(){"use strict";var MOUSE_PROPS=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"],MOUSE_DEFAULTS=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0];function PointerEvent(pressure,inDict){inDict=inDict||Object.create(null);var e=document.createEvent("Event");e.initEvent(pressure,inDict.bubbles||!1,inDict.cancelable||!1);for(var p,i=2;i<MOUSE_PROPS.length;i++)e[p=MOUSE_PROPS[i]]=inDict[p]||MOUSE_DEFAULTS[i];e.buttons=inDict.buttons||0;pressure=0,pressure=inDict.pressure&&e.buttons?inDict.pressure:e.buttons?.5:0;return e.x=e.clientX,e.y=e.clientY,e.pointerId=inDict.pointerId||0,e.width=inDict.width||0,e.height=inDict.height||0,e.pressure=pressure,e.tiltX=inDict.tiltX||0,e.tiltY=inDict.tiltY||0,e.twist=inDict.twist||0,e.tangentialPressure=inDict.tangentialPressure||0,e.pointerType=inDict.pointerType||"",e.hwTimestamp=inDict.hwTimestamp||0,e.isPrimary=inDict.isPrimary||!1,e}var PointerMap=window.Map&&window.Map.prototype.forEach?Map:SparseArrayMap;function SparseArrayMap(){this.array=[],this.size=0}var CLONE_PROPS=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp"],CLONE_DEFAULTS=[!(SparseArrayMap.prototype={set:function(k,v){if(void 0===v)return this.delete(k);this.has(k)||this.size++,this.array[k]=v},has:function(k){return void 0!==this.array[k]},delete:function(k){this.has(k)&&(delete this.array[k],this.size--)},get:function(k){return this.array[k]},clear:function(){this.array.length=0,this.size=0},forEach:function(callback,thisArg){return this.array.forEach(function(v,k){callback.call(thisArg,v,k,this)},this)}}),!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],BOUNDARY_EVENTS={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},HAS_SVG_INSTANCE="undefined"!=typeof SVGElementInstance,dispatcher={pointermap:new PointerMap,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(name,newEvents){var s=newEvents,newEvents=s.events;newEvents&&(newEvents.forEach(function(e){s[e]&&(this.eventMap[e]=s[e].bind(s))},this),this.eventSources[name]=s,this.eventSourceList.push(s))},register:function(element){for(var es,l=this.eventSourceList.length,i=0;i<l&&(es=this.eventSourceList[i]);i++)es.register.call(es,element)},unregister:function(element){for(var es,l=this.eventSourceList.length,i=0;i<l&&(es=this.eventSourceList[i]);i++)es.unregister.call(es,element)},contains:function(container,contained){try{return container.contains(contained)}catch(ex){return!1}},down:function(inEvent){inEvent.bubbles=!0,this.fireEvent("pointerdown",inEvent)},move:function(inEvent){inEvent.bubbles=!0,this.fireEvent("pointermove",inEvent)},up:function(inEvent){inEvent.bubbles=!0,this.fireEvent("pointerup",inEvent)},enter:function(inEvent){inEvent.bubbles=!1,this.fireEvent("pointerenter",inEvent)},leave:function(inEvent){inEvent.bubbles=!1,this.fireEvent("pointerleave",inEvent)},over:function(inEvent){inEvent.bubbles=!0,this.fireEvent("pointerover",inEvent)},out:function(inEvent){inEvent.bubbles=!0,this.fireEvent("pointerout",inEvent)},cancel:function(inEvent){inEvent.bubbles=!0,this.fireEvent("pointercancel",inEvent)},leaveOut:function(event){this.out(event),this.propagate(event,this.leave,!1)},enterOver:function(event){this.over(event),this.propagate(event,this.enter,!0)},eventHandler:function(inEvent){var fn;inEvent._handledByPE||(fn=inEvent.type,(fn=this.eventMap&&this.eventMap[fn])&&fn(inEvent),inEvent._handledByPE=!0)},listen:function(target,events){events.forEach(function(e){this.addEvent(target,e)},this)},unlisten:function(target,events){events.forEach(function(e){this.removeEvent(target,e)},this)},addEvent:function(target,eventName){target.addEventListener(eventName,this.boundHandler)},removeEvent:function(target,eventName){target.removeEventListener(eventName,this.boundHandler)},makeEvent:function(e,inEvent){this.captureInfo[inEvent.pointerId]&&(inEvent.relatedTarget=null);e=new PointerEvent(e,inEvent);return inEvent.preventDefault&&(e.preventDefault=inEvent.preventDefault),e._target=e._target||inEvent.target,e},fireEvent:function(inType,e){e=this.makeEvent(inType,e);return this.dispatchEvent(e)},cloneEvent:function(inEvent){for(var p,eventCopy=Object.create(null),i=0;i<CLONE_PROPS.length;i++)eventCopy[p=CLONE_PROPS[i]]=inEvent[p]||CLONE_DEFAULTS[i],!HAS_SVG_INSTANCE||"target"!==p&&"relatedTarget"!==p||eventCopy[p]instanceof SVGElementInstance&&(eventCopy[p]=eventCopy[p].correspondingUseElement);return inEvent.preventDefault&&(eventCopy.preventDefault=function(){inEvent.preventDefault()}),eventCopy},getTarget:function(inEvent){var capture=this.captureInfo[inEvent.pointerId];return capture?inEvent._target!==capture&&inEvent.type in BOUNDARY_EVENTS?void 0:capture:inEvent._target},propagate:function(event,fn,propagateDown){for(var target=event.target,targets=[];target!==document&&!target.contains(event.relatedTarget);)if(targets.push(target),!(target=target.parentNode))return;propagateDown&&targets.reverse(),targets.forEach(function(target){event.target=target,fn.call(this,event)},this)},setCapture:function(inPointerId,inTarget,skipDispatch){this.captureInfo[inPointerId]&&this.releaseCapture(inPointerId,skipDispatch),this.captureInfo[inPointerId]=inTarget,this.implicitRelease=this.releaseCapture.bind(this,inPointerId,skipDispatch),document.addEventListener("pointerup",this.implicitRelease),document.addEventListener("pointercancel",this.implicitRelease);var e=new PointerEvent("gotpointercapture");e.pointerId=inPointerId,e._target=inTarget,skipDispatch||this.asyncDispatchEvent(e)},releaseCapture:function(inPointerId,skipDispatch){var e,t=this.captureInfo[inPointerId];t&&(this.captureInfo[inPointerId]=void 0,document.removeEventListener("pointerup",this.implicitRelease),document.removeEventListener("pointercancel",this.implicitRelease),(e=new PointerEvent("lostpointercapture")).pointerId=inPointerId,e._target=t,skipDispatch||this.asyncDispatchEvent(e))},dispatchEvent:function(inEvent){var t=this.getTarget(inEvent);if(t)return t.dispatchEvent(inEvent)},asyncDispatchEvent:function(inEvent){requestAnimationFrame(this.dispatchEvent.bind(this,inEvent))}};dispatcher.boundHandler=dispatcher.eventHandler.bind(dispatcher);var targeting={shadow:function(inEl){if(inEl)return inEl.shadowRoot||inEl.webkitShadowRoot},canTarget:function(shadow){return shadow&&Boolean(shadow.elementFromPoint)},targetingShadow:function(s){s=this.shadow(s);if(this.canTarget(s))return s},olderShadow:function(se){var os=se.olderShadowRoot;return os||(se=se.querySelector("shadow"))&&(os=se.olderShadowRoot),os},allShadows:function(element){for(var shadows=[],s=this.shadow(element);s;)shadows.push(s),s=this.olderShadow(s);return shadows},searchRoot:function(t,x,y){if(t){for(var st,t=t.elementFromPoint(x,y),sr=this.targetingShadow(t);sr;){if(st=sr.elementFromPoint(x,y)){var ssr=this.targetingShadow(st);return this.searchRoot(ssr,x,y)||st}sr=this.olderShadow(sr)}return t}},owner:function(element){for(var s=element;s.parentNode;)s=s.parentNode;return s.nodeType!==Node.DOCUMENT_NODE&&s.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(s=document),s},findTarget:function(s){var x=s.clientX,y=s.clientY,s=this.owner(s.target);return s.elementFromPoint(x,y)||(s=document),this.searchRoot(s,x,y)}},forEach=Array.prototype.forEach.call.bind(Array.prototype.forEach),map=Array.prototype.map.call.bind(Array.prototype.map),toArray=Array.prototype.slice.call.bind(Array.prototype.slice),filter=Array.prototype.filter.call.bind(Array.prototype.filter),MO=window.MutationObserver||window.WebKitMutationObserver,OBSERVER_INIT={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};function Installer(add,remove,changed,binder){this.addCallback=add.bind(binder),this.removeCallback=remove.bind(binder),this.changedCallback=changed.bind(binder),MO&&(this.observer=new MO(this.mutationWatcher.bind(this)))}function shadowSelector(v){return"body /shadow-deep/ "+selector(v)}function selector(v){return'[touch-action="'+v+'"]'}function rule(v){return"{ -ms-touch-action: "+v+"; touch-action: "+v+"; }"}Installer.prototype={watchSubtree:function(target){this.observer&&targeting.canTarget(target)&&this.observer.observe(target,OBSERVER_INIT)},enableOnSubtree:function(target){this.watchSubtree(target),target===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(target)},installNewSubtree:function(target){forEach(this.findElements(target),this.addElement,this)},findElements:function(target){return target.querySelectorAll?target.querySelectorAll("[touch-action]"):[]},removeElement:function(el){this.removeCallback(el)},addElement:function(el){this.addCallback(el)},elementChanged:function(el,oldValue){this.changedCallback(el,oldValue)},concatLists:function(accum,list){return accum.concat(toArray(list))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(n){return n.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(inNodes){var tree=map(inNodes,this.findElements,this);return tree.push(filter(inNodes,this.isElement)),tree.reduce(this.concatLists,[])},mutationWatcher:function(mutations){mutations.forEach(this.mutationHandler,this)},mutationHandler:function(m){"childList"===m.type?(this.flattenMutationTree(m.addedNodes).forEach(this.addElement,this),this.flattenMutationTree(m.removedNodes).forEach(this.removeElement,this)):"attributes"===m.type&&this.elementChanged(m.target,m.oldValue)}};var attrib2css=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],styles="",hasNativePE=window.PointerEvent||window.MSPointerEvent,hasShadowRoot=!window.ShadowDOMPolyfill&&document.head.createShadowRoot;var pointermap=dispatcher.pointermap,BUTTON_TO_BUTTONS=[1,4,2,8,16],HAS_BUTTONS=!1;try{HAS_BUTTONS=1===new MouseEvent("test",{buttons:1}).buttons}catch(e){}var mouseEvents={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(target){dispatcher.listen(target,this.events)},unregister:function(target){dispatcher.unlisten(target,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(inEvent){for(var t,lts=this.lastTouches,x=inEvent.clientX,y=inEvent.clientY,i=0,l=lts.length;i<l&&(t=lts[i]);i++){var dx=Math.abs(x-t.x),dy=Math.abs(y-t.y);if(dx<=25&&dy<=25)return!0}},prepareEvent:function(inEvent){var e=dispatcher.cloneEvent(inEvent),pd=e.preventDefault;return e.preventDefault=function(){inEvent.preventDefault(),pd()},e.pointerId=this.POINTER_ID,e.isPrimary=!0,e.pointerType=this.POINTER_TYPE,e},prepareButtonsForMove:function(e,inEvent){var p=pointermap.get(this.POINTER_ID);0!==inEvent.which&&p?e.buttons=p.buttons:e.buttons=0,inEvent.buttons=e.buttons},mousedown:function(inEvent){var p,e;this.isEventSimulatedFromTouch(inEvent)||(p=pointermap.get(this.POINTER_ID),e=this.prepareEvent(inEvent),HAS_BUTTONS||(e.buttons=BUTTON_TO_BUTTONS[e.button],p&&(e.buttons|=p.buttons),inEvent.buttons=e.buttons),pointermap.set(this.POINTER_ID,inEvent),p&&0!==p.buttons?dispatcher.move(e):dispatcher.down(e))},mousemove:function(inEvent){var e;this.isEventSimulatedFromTouch(inEvent)||(e=this.prepareEvent(inEvent),HAS_BUTTONS||this.prepareButtonsForMove(e,inEvent),e.button=-1,pointermap.set(this.POINTER_ID,inEvent),dispatcher.move(e))},mouseup:function(inEvent){var p,e,up;this.isEventSimulatedFromTouch(inEvent)||(p=pointermap.get(this.POINTER_ID),e=this.prepareEvent(inEvent),HAS_BUTTONS||(up=BUTTON_TO_BUTTONS[e.button],e.buttons=p?p.buttons&~up:0,inEvent.buttons=e.buttons),pointermap.set(this.POINTER_ID,inEvent),e.buttons&=~BUTTON_TO_BUTTONS[e.button],0===e.buttons?dispatcher.up(e):dispatcher.move(e))},mouseover:function(inEvent){var e;this.isEventSimulatedFromTouch(inEvent)||(e=this.prepareEvent(inEvent),HAS_BUTTONS||this.prepareButtonsForMove(e,inEvent),e.button=-1,pointermap.set(this.POINTER_ID,inEvent),dispatcher.enterOver(e))},mouseout:function(inEvent){var e;this.isEventSimulatedFromTouch(inEvent)||(e=this.prepareEvent(inEvent),HAS_BUTTONS||this.prepareButtonsForMove(e,inEvent),e.button=-1,dispatcher.leaveOut(e))},cancel:function(e){e=this.prepareEvent(e);dispatcher.cancel(e),this.deactivateMouse()},deactivateMouse:function(){pointermap.delete(this.POINTER_ID)}},captureInfo=dispatcher.captureInfo,findTarget=targeting.findTarget.bind(targeting),allShadows=targeting.allShadows.bind(targeting),pointermap$1=dispatcher.pointermap,touchEvents={events:["touchstart","touchmove","touchend","touchcancel"],register:function(target){INSTALLER.enableOnSubtree(target)},unregister:function(){},elementAdded:function(el){var a=el.getAttribute("touch-action"),st=this.touchActionToScrollType(a);st&&(el._scrollType=st,dispatcher.listen(el,this.events),allShadows(el).forEach(function(s){s._scrollType=st,dispatcher.listen(s,this.events)},this))},elementRemoved:function(el){el._scrollType=void 0,dispatcher.unlisten(el,this.events),allShadows(el).forEach(function(s){s._scrollType=void 0,dispatcher.unlisten(s,this.events)},this)},elementChanged:function(el,oldSt){var a=el.getAttribute("touch-action"),st=this.touchActionToScrollType(a),oldSt=this.touchActionToScrollType(oldSt);st&&oldSt?(el._scrollType=st,allShadows(el).forEach(function(s){s._scrollType=st},this)):oldSt?this.elementRemoved(el):st&&this.elementAdded(el)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(touchAction){var st=this.scrollTypes;return"none"===touchAction?"none":touchAction===st.XSCROLLER?"X":touchAction===st.YSCROLLER?"Y":st.SCROLLER.exec(touchAction)?"XY":void 0},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(inTouch){return this.firstTouch===inTouch.identifier},setPrimaryTouch:function(inTouch){(0===pointermap$1.size||1===pointermap$1.size&&pointermap$1.has(1))&&(this.firstTouch=inTouch.identifier,this.firstXY={X:inTouch.clientX,Y:inTouch.clientY},this.scrolling=!1,this.cancelResetClickCount())},removePrimaryPointer:function(inPointer){inPointer.isPrimary&&(this.firstTouch=null,this.firstXY=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var fn=function(){this.clickCount=0,this.resetId=null}.bind(this);this.resetId=setTimeout(fn,200)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(type){return"touchstart"!==type&&"touchmove"!==type?0:1},touchToPointer:function(inTouch){var cte=this.currentTouchEvent,e=dispatcher.cloneEvent(inTouch),id=e.pointerId=inTouch.identifier+2;e.target=captureInfo[id]||findTarget(e),e.bubbles=!0,e.cancelable=!0,e.detail=this.clickCount,e.button=0,e.buttons=this.typeToButtons(cte.type),e.width=2*(inTouch.radiusX||inTouch.webkitRadiusX||0),e.height=2*(inTouch.radiusY||inTouch.webkitRadiusY||0),e.pressure=inTouch.force||inTouch.webkitForce||.5,e.isPrimary=this.isPrimaryTouch(inTouch),e.pointerType=this.POINTER_TYPE,e.altKey=cte.altKey,e.ctrlKey=cte.ctrlKey,e.metaKey=cte.metaKey,e.shiftKey=cte.shiftKey;var self=this;return e.preventDefault=function(){self.scrolling=!1,self.firstXY=null,cte.preventDefault()},e},processTouches:function(inEvent,inFunction){var tl=inEvent.changedTouches;this.currentTouchEvent=inEvent;for(var t,i=0;i<tl.length;i++)t=tl[i],inFunction.call(this,this.touchToPointer(t))},shouldScroll:function(oa){if(this.firstXY){var t,ret,scrollAxis=oa.currentTarget._scrollType;return ret="none"!==scrollAxis&&("XY"===scrollAxis||(t=oa.changedTouches[0],oa="Y"===scrollAxis?"X":"Y",ret=Math.abs(t["client"+scrollAxis]-this.firstXY[scrollAxis]),Math.abs(t["client"+oa]-this.firstXY[oa])<=ret)),this.firstXY=null,ret}},findTouch:function(inTL,inId){for(var t,i=0,l=inTL.length;i<l&&(t=inTL[i]);i++)if(t.identifier===inId)return!0},vacuumTouches:function(inEvent){var d,tl=inEvent.touches;pointermap$1.size>=tl.length&&(d=[],pointermap$1.forEach(function(p,key){1===key||this.findTouch(tl,key-2)||(p=p.out,d.push(p))},this),d.forEach(this.cancelOut,this))},touchstart:function(inEvent){this.vacuumTouches(inEvent),this.setPrimaryTouch(inEvent.changedTouches[0]),this.dedupSynthMouse(inEvent),this.scrolling||(this.clickCount++,this.processTouches(inEvent,this.overDown))},overDown:function(inPointer){pointermap$1.set(inPointer.pointerId,{target:inPointer.target,out:inPointer,outTarget:inPointer.target}),dispatcher.enterOver(inPointer),dispatcher.down(inPointer)},touchmove:function(inEvent){this.scrolling||(this.shouldScroll(inEvent)?(this.scrolling=!0,this.touchcancel(inEvent)):(inEvent.preventDefault(),this.processTouches(inEvent,this.moveOverOut)))},moveOverOut:function(outTarget){var outEvent,event=outTarget,pointer=pointermap$1.get(event.pointerId);pointer&&(outEvent=pointer.out,outTarget=pointer.outTarget,dispatcher.move(event),outEvent&&outTarget!==event.target&&(outEvent.relatedTarget=event.target,event.relatedTarget=outTarget,outEvent.target=outTarget,event.target?(dispatcher.leaveOut(outEvent),dispatcher.enterOver(event)):(event.target=outTarget,event.relatedTarget=null,this.cancelOut(event))),pointer.out=event,pointer.outTarget=event.target)},touchend:function(inEvent){this.dedupSynthMouse(inEvent),this.processTouches(inEvent,this.upOut)},upOut:function(inPointer){this.scrolling||(dispatcher.up(inPointer),dispatcher.leaveOut(inPointer)),this.cleanUpPointer(inPointer)},touchcancel:function(inEvent){this.processTouches(inEvent,this.cancelOut)},cancelOut:function(inPointer){dispatcher.cancel(inPointer),dispatcher.leaveOut(inPointer),this.cleanUpPointer(inPointer)},cleanUpPointer:function(inPointer){pointermap$1.delete(inPointer.pointerId),this.removePrimaryPointer(inPointer)},dedupSynthMouse:function(fn){var lts=mouseEvents.lastTouches,fn=fn.changedTouches[0];this.isPrimaryTouch(fn)&&(fn={x:fn.clientX,y:fn.clientY},lts.push(fn),fn=function(lts,i){i=lts.indexOf(i);-1<i&&lts.splice(i,1)}.bind(null,lts,fn),setTimeout(fn,2500))}},INSTALLER=new Installer(touchEvents.elementAdded,touchEvents.elementRemoved,touchEvents.elementChanged,touchEvents),pointermap$2=dispatcher.pointermap,HAS_BITMAP_TYPE=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,msEvents={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(target){dispatcher.listen(target,this.events)},unregister:function(target){dispatcher.unlisten(target,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(inEvent){var e=inEvent;return HAS_BITMAP_TYPE&&((e=dispatcher.cloneEvent(inEvent)).pointerType=this.POINTER_TYPES[inEvent.pointerType]),e},cleanup:function(id){pointermap$2.delete(id)},MSPointerDown:function(e){pointermap$2.set(e.pointerId,e);e=this.prepareEvent(e);dispatcher.down(e)},MSPointerMove:function(e){e=this.prepareEvent(e);dispatcher.move(e)},MSPointerUp:function(inEvent){var e=this.prepareEvent(inEvent);dispatcher.up(e),this.cleanup(inEvent.pointerId)},MSPointerOut:function(e){e=this.prepareEvent(e);dispatcher.leaveOut(e)},MSPointerOver:function(e){e=this.prepareEvent(e);dispatcher.enterOver(e)},MSPointerCancel:function(inEvent){var e=this.prepareEvent(inEvent);dispatcher.cancel(e),this.cleanup(inEvent.pointerId)},MSLostPointerCapture:function(e){e=dispatcher.makeEvent("lostpointercapture",e);dispatcher.dispatchEvent(e)},MSGotPointerCapture:function(e){e=dispatcher.makeEvent("gotpointercapture",e);dispatcher.dispatchEvent(e)}};var s,r,h,el,tp,n=window.navigator;function assertActive(error){if(!dispatcher.pointermap.has(error)){error=new Error("InvalidPointerId");throw error.name="InvalidPointerId",error}}function assertConnected(elem){for(var parent=elem.parentNode;parent&&parent!==elem.ownerDocument;)parent=parent.parentNode;if(!parent){var error=new Error("InvalidStateError");throw error.name="InvalidStateError",error}}function inActiveButtonState(id){return 0!==dispatcher.pointermap.get(id).buttons}return r=n.msPointerEnabled?(s=function(pointerId){assertActive(pointerId),assertConnected(this),inActiveButtonState(pointerId)&&(dispatcher.setCapture(pointerId,this,!0),this.msSetPointerCapture(pointerId))},function(pointerId){assertActive(pointerId),dispatcher.releaseCapture(pointerId,!0),this.msReleasePointerCapture(pointerId)}):(s=function(pointerId){assertActive(pointerId),assertConnected(this),inActiveButtonState(pointerId)&&dispatcher.setCapture(pointerId,this)},function(pointerId){assertActive(pointerId),dispatcher.releaseCapture(pointerId)}),h=function(pointerId){return!!dispatcher.captureInfo[pointerId]},hasNativePE&&(attrib2css.forEach(function(r){String(r)===r?(styles+=selector(r)+rule(r)+"\n",hasShadowRoot&&(styles+=shadowSelector(r)+rule(r)+"\n")):(styles+=r.selectors.map(selector)+rule(r.rule)+"\n",hasShadowRoot&&(styles+=r.selectors.map(shadowSelector)+rule(r.rule)+"\n"))}),(el=document.createElement("style")).textContent=styles,document.head.appendChild(el)),window.PointerEvent||(window.PointerEvent=PointerEvent,window.navigator.msPointerEnabled?(tp=window.navigator.msMaxTouchPoints,Object.defineProperty(window.navigator,"maxTouchPoints",{value:tp,enumerable:!0}),dispatcher.registerSource("ms",msEvents)):(Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),dispatcher.registerSource("mouse",mouseEvents),void 0!==window.ontouchstart&&dispatcher.registerSource("touch",touchEvents)),dispatcher.register(document)),window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:s},releasePointerCapture:{value:r},hasPointerCapture:{value:h}}),{dispatcher:dispatcher,Installer:Installer,PointerEvent:PointerEvent,PointerMap:PointerMap,targetFinding:targeting}});